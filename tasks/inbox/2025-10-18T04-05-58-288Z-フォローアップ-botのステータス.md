---
title: 'フォローアップ: Botのステータス'
priority: normal
priority_label: 通常
summary: 機能実装のお願い
created_at: '2025-10-18T04:05:58.286Z'
author:
  id: '802792088893652992'
  tag: no_libft_no_life
channel_id: '1411214661612867624'
interaction_id: '1428957251422654587'
parent:
  run_id: de1818bc-dc1a-4b1c-abf4-194652f64bca
  queue_id: null
  task_filename: 2025-10-18T03-45-44-909Z-botのステータス.md
  history_path: null
---

## 概要

機能実装のお願い

## 詳細

### 元タスク情報

- タイトル: Botのステータス
- ファイル名: `2025-10-18T03-45-44-909Z-botのステータス.md`
- 優先度: 通常
- 概要: BOTが使用可能かどうかステータスでわかるようにしたい。

### 前回の Codex 応答
```markdown
**対応案**
- `bot-runtime/src/discord/client.ts` の `ready` ハンドラで PresenceManager を初期化し、起動直後とヘルスイベント発生時にステータスを更新できるよう `healthRegistry.subscribe` を呼び出す。
- `bot-runtime/src/discord/presenceManager.ts`（新規）を用意し、`collectHealthIssueSummary` を使ってヘルス警告の有無に応じて `status`（`online`/`idle`/`dnd`）とアクティビティ文言（例: `🟢 利用可能`, `⚠️ 警告中`, `🛑 障害対応中`）を切り替える処理を実装する。
- 設定ホットリロード時にも現在の構成／ヘルス結果で Presence を再計算できるよう、`DiscordRuntime.applyConfigUpdate` から PresenceManager の `refresh` を呼ぶフックを追加する。

**確認方法**
- `npm run dev` でローカル起動し、Discord クライアント上でステータスが `🟢 利用可能` などに変わることを確認する。
- 通知チャンネル未設定などでヘルス警告を強制発生させ、Presence が `⚠️`／`🛑` 系の文言と `idle`／`dnd` に遷移するか確認する。
- 警告を解消した際に Presence が自動で正常状態へ戻ることを確認する。

**補足**
- 現在の実行環境は read-only のためコード変更はまだ行っていません。書き込み可能になったら上記手順で実装し、合わせて `docs/plans.md` に今回の対応方針と決定事項を追記してください。
- ステータス文言は依頼者の希望に合わせて調整可能です。必要であれば将来的に設定ファイル経由でカスタマイズできるよう拡張する選択肢もあります。
```

### 追加依頼内容

read-onlyの方を先ほど解除しましたので、実際に機能を実装して欲しいと思います。

### 参考: 元タスク本文

## 概要

BOTが使用可能かどうかステータスでわかるようにしたい。

## 詳細

› 今このDiscord Botって僕のPCが起動しているかつ、ネットにつながっている状態じゃないと使用できないんだよね。なので、にゃいむきゃっと（BOT名）のステータスで使用可能かどうかわかるといいんだけど可能ですか？可能であれば作業お願いします。

---

_このタスクはDiscord Slash Commandから自動生成されました。_

---

_このタスクは Codex フォローアップ機能から自動生成されました (Run ID: de1818bc-dc1a-4b1c-abf4-194652f64bca)。_