# Codex連携オートメーション - タスクリスト

## 目的
Discord からの Slash コマンド経由で Codex CLI を起動し、保存されたプロンプトをもとに `Task.md` / `Plans.md` の更新や作業実行を自走化する仕組みを整備する。

## タスク
- [ ] Slash コマンド設計
  - [x] `/task create`: 概要・詳細・優先度を受け取り、`tasks/inbox/` に Markdown で保存するフローを実装。
  - [ ] `/work start` / `/work status` / `/work cancel` といった作業実行系コマンドのワークフローを決める。
- [ ] プロンプト保管レイヤーの実装
  - [x] 指定フォルダ（例: `tasks/inbox/`）へ依頼内容をテキストで蓄積する。
  - [x] ファイル命名規則・メタデータ（依頼者、チャンネル、タイムスタンプなど）を設計する。
  - [x] Inbox の一覧／詳細確認／削除を行う CLI (`npm run task-inbox`) を整備する。
- [ ] Codex CLI 連携ランナー  
  - Bot からローカル Codex CLI をキックするためのスクリプト／API を用意する。  
  - CLI が Task/Plans を更新し、結果を返却するためのインターフェースを整備する。
- [ ] 結果連携と通知  
  - CLI 実行結果（成功／失敗／出力ファイルなど）を Discord に投稿する仕組みを作る。  
  - 長時間処理への対応として、ステータス更新やフォローアップメッセージを整理する。
- [ ] セキュリティ／権限管理  
  - Slash コマンド利用者の制限（ロールチェック等）と、危険な依頼をフィルターするルールを定義する。  
  - Codex CLI 側で実行できる操作範囲を制御し、ファイルパスのサニタイズなどを行う。
- [ ] 運用／監視  
  - 失敗時のリトライ／アラート、ログ収集方法を決める。  
  - `/status` コマンドなど稼働監視の追加と、トラブルシュート手順を文書化する。

## メモ
- MVP ではローカルマシン上で Bot と Codex CLI が同居する前提。将来的にリモートワーカーとの連携も検討。  
- Plans.md 運用ルール（exec plan）は CLI 側で自動的に満たすフローを設ける。  
- 実装着手前に Slash コマンド登録や必要なBot権限を確認しておく。
